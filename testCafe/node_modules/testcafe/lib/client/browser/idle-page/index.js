!function(t){"use strict";var n,e,i,o,r,s={".js":[],".json":[],".css":[],".html":[]},a="function"==typeof require?require:null;return o=function(t){var n=new Error("Could not find module '"+t+"'");return n.code="MODULE_NOT_FOUND",n},r=function(t,n,e){var i,o;if("function"==typeof t[n+e])return n+e;for(i=0;o=s[e][i];++i)if("function"==typeof t[n+o])return n+o;return null},n=function(t,i,s,a,c,u){var l,h,f,d,p,_;for(s=s.split(/[\\\/]/),l=s.pop(),"."!==l&&".."!==l||(s.push(l),l="");null!=(h=s.shift());)if(h&&"."!==h&&(".."===h?(t=i.pop(),u=u.slice(0,u.lastIndexOf("/"))):(i.push(t),t=t[h],u+="/"+h),!t))throw o(a);if(l&&"function"!=typeof t[l]&&(_=r(t,l,".js"),_||(_=r(t,l,".json")),_||(_=r(t,l,".css")),_||(_=r(t,l,".html")),_?l=_:2!==c&&"object"==typeof t[l]&&(i.push(t),t=t[l],u+="/"+l,l="")),!l)return 1!==c&&t[":mainpath:"]?n(t,i,t[":mainpath:"],a,1,u):n(t,i,"index",a,2,u);if(p=t[l],!p)throw o(a);return p.hasOwnProperty("module")?p.module.exports:(f={},p.module=d={exports:f,id:u+"/"+l},p.call(f,f,d,e(t,i,u)),d.exports)},i=function(e,i,r,s){var c,u=r,l=r.charAt(0),h=0;if("/"===l){if(u=u.slice(1),e=t["/"],!e){if(a)return a(r);throw o(r)}s="/",i=[]}else if("."!==l){if(c=u.split("/",1)[0],e=t[c],!e){if(a)return a(r);throw o(r)}s=c,i=[],u=u.slice(c.length+1),u||(u=e[":mainpath:"],u?h=1:(u="index",h=2))}return n(e,i,u,r,h,s)},(e=function(t,n,e){return function(o){return i(t,[].concat(n),o,e)}})(t,[],"")}({pinkie:{"index.js":function(t,n,e){function i(){for(var t=0;t<I.length;t++)I[t][0](I[t][1]);I=[],y=!1}function o(t,n){I.push([t,n]),y||(y=!0,E(i,0))}function r(t,n){function e(t){c(n,t)}function i(t){l(n,t)}try{t(e,i)}catch(o){i(o)}}function s(t){var n=t.owner,e=n._state,i=n._data,o=t[e],r=t.then;if("function"==typeof o){e=x;try{i=o(i)}catch(s){l(r,s)}}a(r,i)||(e===x&&c(r,i),e===S&&l(r,i))}function a(t,n){var e;try{if(t===n)throw new TypeError("A promises callback cannot return that same promise.");if(n&&("function"==typeof n||"object"===("undefined"==typeof n?"undefined":m(n)))){var i=n.then;if("function"==typeof i)return i.call(n,function(i){e||(e=!0,n===i?u(t,i):c(t,i))},function(n){e||(e=!0,l(t,n))}),!0}}catch(o){return e||l(t,o),!0}return!1}function c(t,n){t!==n&&a(t,n)||u(t,n)}function u(t,n){t._state===w&&(t._state=g,t._data=n,o(f,t))}function l(t,n){t._state===w&&(t._state=g,t._data=n,o(d,t))}function h(t){t._then=t._then.forEach(s)}function f(t){t._state=x,h(t)}function d(t){t._state=S,h(t),!t._handled&&C&&global.process.emit("unhandledRejection",t._data,t)}function p(t){global.process.emit("rejectionHandled",t)}function _(t){if("function"!=typeof t)throw new TypeError("Promise resolver "+t+" is not a function");if(this instanceof _==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],r(t,this)}var y,m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w="pending",g="settled",x="fulfilled",S="rejected",v=function(){},C="undefined"!=typeof global&&"undefined"!=typeof global.process&&"function"==typeof global.process.emit,E="undefined"==typeof setImmediate?setTimeout:setImmediate,I=[];_.prototype={constructor:_,_state:w,_then:null,_data:void 0,_handled:!1,then:function(t,n){var e={owner:this,then:new this.constructor(v),fulfilled:t,rejected:n};return!n&&!t||this._handled||(this._handled=!0,this._state===S&&C&&o(p,this)),this._state===x||this._state===S?o(s,e):this._then.push(e),e.then},"catch":function(t){return this.then(null,t)}},_.all=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new _(function(n,e){function i(t){return s++,function(e){r[t]=e,--s||n(r)}}for(var o,r=[],s=0,a=0;a<t.length;a++)o=t[a],o&&"function"==typeof o.then?o.then(i(a),e):r[a]=o;s||n(r)})},_.race=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new _(function(n,e){for(var i,o=0;o<t.length;o++)i=t[o],i&&"function"==typeof i.then?i.then(n,e):n(i)})},_.resolve=function(t){return t&&"object"===("undefined"==typeof t?"undefined":m(t))&&t.constructor===_?t:new _(function(n){n(t)})},_.reject=function(t){return new _(function(n,e){e(t)})},n.exports=_}},"testcafe-phoenix":{src:{browser:{connection:{"command.js":function(t,n,e){t.__esModule=!0,t["default"]={run:"run",idle:"idle"},n.exports=t["default"]},"status.js":function(t,n,e){t.__esModule=!0,t["default"]={ok:"ok",closing:"closing"},n.exports=t["default"]}}},client:{browser:{"idle-page":{"index.js":function(t,n,e){function i(t){return t&&t.__esModule?t:{"default":t}}function o(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n["default"]=t,n}function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var s=e("../"),a=o(s),c=e("./status-indicator"),u=i(c),l=e("../../../browser/connection/command"),h=i(l),f=1e3,d=function(){return new XMLHttpRequest},p=function(){function t(n,e,i){r(this,t),this.statusUrl=n,this.statusIndicator=new u["default"],a.startHeartbeat(e,d),a.startInitScriptExecution(i,d),this._checkStatus(),document.title="["+document.location.toString()+"]"}return t.prototype._checkStatus=function(){var t=this;a.checkStatus(this.statusUrl,d).then(function(n){n===h["default"].idle&&window.setTimeout(function(){return t._checkStatus()},f)})["catch"](function(){return t.statusIndicator.showDisconnection()})},t}();window.IdlePage=p},"status-indicator.js":function(t,n,e){function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function o(t){return t*Math.PI/180}function r(t){return t+"px"}function s(t,n){var e=o(n);return{x:Math.round(t.x*Math.cos(e)-t.y*Math.sin(e)),y:Math.round(t.x*Math.sin(e)+t.y*Math.cos(e))}}function a(t,n){return{x:Math.round(t.x-n),y:Math.round(t.y-n)}}t.__esModule=!0;var c=8,u=.8,l=400,h=7,f=.03,d=3.5,p={x:.75,y:.7},_={x:1.025,y:.575},y=6,m="#28687F",w="#882E24",g="#181818",x="CONNECTED",S="DISCONNECTED",v="page-background",C="container",E="user-agent",I="status",M="spinner",b="connected",z="disconnected",R=30,A=function(){function t(){i(this,t),this.connected=!0,this.canvas=document.getElementsByClassName(M)[0],this.canvasContext=this.canvas.getContext("2d"),this.spinnerAnimationInterval=null,this.rotationAngle=0,this.size=null,this.spinnerCenter=null,this.gradient=null,this._setSize(),this._setFontSize(),this._setSpinnerGradient(),t._createStatusMessage(this.connected),t._alignContainerVertically(),this._drawSpinner(this.connected,0),this._watchWindowResize()}return t._getContainer=function(){return document.getElementsByClassName(C)[0]},t._getStatusElementSpan=function(){return document.getElementsByClassName(I)[0].children[0]},t._createStatusMessage=function(n){var e=t._getStatusElementSpan();e.className=n?b:z,e.textContent=n?x:S},t._alignContainerVertically=function(){var n=document.getElementsByClassName(v)[0],e=t._getContainer(),i=Math.ceil((n.offsetHeight-e.offsetHeight)/2);i>0&&(e.style.marginTop=r(i))},t.prototype._setSize=function(){var n=window.document.documentElement,e=Math.min(n.clientWidth,n.clientHeight),i=t._getContainer(),o=Math.round(Math.min(l,e*u));o!==this.size&&(this.size=Math.round(Math.min(l,e*u)),this.spinnerCenter=this.size/2,i.style.width=r(this.size),i.style.height=r(this.size),this.canvas.width=this.canvas.height=this.size)},t.prototype._setFontSize=function(){var n=document.getElementsByClassName(E)[0].children[0],e=t._getStatusElementSpan(),i=Math.round(f*this.size+d),o=i+y;n.style.fontSize=r(i),n.style.lineHeight=r(o),n.style.maxHeight=r(2*o),e.style.fontSize=r(i),e.style.lineHeight=r(o-1)},t.prototype._watchWindowResize=function(){var n=this;window.onresize=function(){var e=n.size;n._setSize(),n._setFontSize(),t._alignContainerVertically(),e!==n.size&&(n.connected&&n._setSpinnerGradient(),n._drawSpinner(n.connected,n.rotationAngle))}},t.prototype._drawSpinner=function(t,n){var e=this;this._clearCanvas(),clearInterval(this.spinnerAnimationInterval),t?(this.spinnerAnimationInterval=window.setInterval(function(){e._clearCanvas(),e._rotateSpinner(),e._drawCircle(e.gradient,240,n)},R),this._drawCircle(this.gradient,240,n)):this._drawCircle(w,360,0)},t.prototype._drawCircle=function(t,n,e){var i=this.spinnerCenter-c/2;this.canvasContext.beginPath(),this.canvasContext.lineWidth=c,this.canvasContext.strokeStyle=t,this.canvasContext.arc(this.spinnerCenter,this.spinnerCenter,i,o(e),o(e+n),!1),this.canvasContext.stroke()},t.prototype._rotateSpinner=function(){this.rotationAngle+=h,this.rotationAngle=this.rotationAngle>360?this.rotationAngle%360:this.rotationAngle,this.canvasContext.translate(this.spinnerCenter,this.spinnerCenter),this.canvasContext.rotate(o(h)),this.canvasContext.translate(-this.spinnerCenter,-this.spinnerCenter)},t.prototype._getRotatedGradientPoints=function(t){var n=a(t,this.spinnerCenter);return n=s(n,this.rotationAngle),n=a(n,-this.spinnerCenter)},t.prototype._setSpinnerGradient=function(){var t={x:Math.round(this.size*p.x),y:Math.round(this.size*p.y)},n={x:Math.round(this.size*_.x),y:Math.round(this.size*_.y)};0!==this.rotationAngle&&(t=this._getRotatedGradientPoints(t),n=this._getRotatedGradientPoints(n));var e=this.canvasContext.createLinearGradient(t.x,t.y,n.x,n.y);e.addColorStop(0,m),e.addColorStop(1,g),this.gradient=e},t.prototype._clearCanvas=function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.showDisconnection=function(){this.connected=!1,t._createStatusMessage(this.connected),this._drawSpinner(this.connected,0)},t}();t["default"]=A,n.exports=t["default"]}},"index.js":function(exports,module,require){function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function sendXHR(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new _pinkie2["default"](function(o,r){var s=n();s.open(e,t,!0),s.onreadystatechange=function(){4===s.readyState&&(200===s.status?o(s.responseText?JSON.parse(s.responseText):""):r("disconnected"))},s.send(i)})}function isCurrentLocation(t){return document.location.href.toLowerCase()===t.toLowerCase()}function startHeartbeat(t,n){function e(){sendXHR(t,n).then(function(t){t.code!==_status2["default"].closing||isCurrentLocation(t.url)||(stopInitScriptExecution(),document.location=t.url)})}window.setInterval(e,HEARTBEAT_INTERVAL),e()}function executeInitScript(initScriptUrl,createXHR){allowInitScriptExecution&&sendXHR(initScriptUrl,createXHR).then(function(res){return res.code?sendXHR(initScriptUrl,createXHR,"POST",JSON.stringify(eval(res.code))):null}).then(function(){window.setTimeout(function(){return executeInitScript(initScriptUrl,createXHR)},1e3)})}function startInitScriptExecution(t,n){allowInitScriptExecution=!0,executeInitScript(t,n)}function stopInitScriptExecution(){allowInitScriptExecution=!1}function checkStatus(t,n){return sendXHR(t,n).then(function(t){return(t.cmd===_command2["default"].run||t.cmd===_command2["default"].idle&&!isCurrentLocation(t.url))&&(stopInitScriptExecution(),document.location=t.url),t.cmd})}exports.__esModule=!0,exports.startHeartbeat=startHeartbeat,exports.startInitScriptExecution=startInitScriptExecution,exports.stopInitScriptExecution=stopInitScriptExecution,exports.checkStatus=checkStatus;var _pinkie=require("pinkie"),_pinkie2=_interopRequireDefault(_pinkie),_command=require("../../browser/connection/command"),_command2=_interopRequireDefault(_command),_status=require("../../browser/connection/status"),_status2=_interopRequireDefault(_status),HEARTBEAT_INTERVAL=2e3,allowInitScriptExecution=!1}}}}}})("testcafe-phoenix/src/client/browser/idle-page/index");